#!/bin/bash
#zshrc functions included from .zshrc

export CONFFILES="~/configfiles"
export SENSFILES="~/sensitive"
export CONFGIT="git@github.com:arik181/configfiles.git"
export SENSGIT="git@github.com:arik181/sensitive.git"
export ALLFILES="~/.zshfunc ~/.zshrc ~/.zshlocal ~/.zshsensitive ~/.vimrc ~/.xinitrc ~/.xmonad/xmonad.hs"
export WEAKFILES=".zshfunc .vimrc .xinitrc"


function pushconf()
{
    cd $CONFFILES
    git commit -a
    git push
    cd $OLDPWD
    cd $SENSFILES
    git commit -a 
    git push
    cd $OLDPWD
}

function updateconf()
{
    cd $CONFFILES
    git pull origin master
    cd $OLDPWD
    cd $SENSFILES
    git pull origin master
    cd $OLDPWD
}

function setupconf()
{
    for file in $ALLFILES; do
        if [ -x $file ]; then
            echo "File $file exists. Aborting."
            exit
        fi
    done

    echo "Setting up directories..."
    if [ -x $CONFFILES]; then
        mkdir $CONFFILES
        cd $CONFFILES
        git clone $CONFGIT
    fi

    if [ -x $SENSFILES]; then
        mkdir $SENSFILES
        cd $SENSFILES
        git clone $SENSGIT
    fi

    echo "Linking files..."
    for file in $WEAKFILES; do
        ln -s ~/configfiles/$file ~/$file
    done

    if [ -x "~/configfiles/.zshrc.(uname)" ]; then
        ln -s ~/configfiles/.zshrc.(uname) ~/.zshrc
    else
        echo "File does not exist: ~/configfiles/.zshrc.`uname`"
    fi

    if [ -x "~/sensitive/.zshlocal.(uname)" ]; then
        ln -s ~/sensitive/.zshlocal.(hostname) ~/.zshlocal
    else
        echo "File does not exist: ~/sensitive/.zshlocal.`hostname`"
    fi

    if [ -x "~/sensitive/.zshsensitive.(hostname)" ]; then
        ln -s ~/sensitive/.zshsensitive.(hostname) ~/.zshsensitive
    else
        echo "File does not exist: ~/sensitive/.zshsensitive.`hostname`"
    fi
}
